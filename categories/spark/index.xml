<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>spark on 语冰</title><link>https://www.yubing.co/categories/spark/</link><description>Recent content in spark on 语冰</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Thu, 11 Nov 2021 11:00:45 +0800</lastBuildDate><atom:link href="https://www.yubing.co/categories/spark/index.xml" rel="self" type="application/rss+xml"/><item><title>Pyspark读取和保存Json文件</title><link>https://www.yubing.co/posts/my-first-post/</link><pubDate>Thu, 11 Nov 2021 11:00:45 +0800</pubDate><guid>https://www.yubing.co/posts/my-first-post/</guid><description>目录 将JSON文件读入DataFrame 读取包含多个单行json的单个Json文件 使用自定义的schema读取json文件 读取包含多行json列表的单个json文件 一次读取多个json文件 读取指定目录下的所有json文件 递归读取指定目录下所有的json文件 将dataframe保存为json文件 保存模式 保存选项 将JSON文件读入DataFrame 读取包含多行json的单个Json文件 forexample.json文件:
{&amp;#34;id&amp;#34;: 0, &amp;#34;name&amp;#34;: &amp;#34;bob&amp;#34;, &amp;#34;time&amp;#34;: &amp;#34;2021-07-23 08:10:59&amp;#34;} {&amp;#34;id&amp;#34;: 1, &amp;#34;name&amp;#34;: &amp;#34;alice&amp;#34;, &amp;#34;time&amp;#34;: &amp;#34;2021-07-21 02:10:00&amp;#34;} {&amp;#34;id&amp;#34;: 2, &amp;#34;name&amp;#34;: &amp;#34;jack&amp;#34;, &amp;#34;time&amp;#34;: &amp;#34;2021-07-24 08:15:51&amp;#34;} df = spark.read.json(&amp;#34;forexample.json&amp;#34;) df.printSchema() df.show() 输出：
root |-- id: long (nullable = true) |-- name: string (nullable = true) |-- time: string (nullable = true) +---+-----+-------------------+ | id| name| time| +---+-----+-------------------+ | 0| bob|2021-07-23 08:10:59| | 1|alice|2021-07-21 02:10:00| | 2| jack|2021-07-24 08:15:51| +---+-----+-------------------+ 使用自定义的schema读取json文件 读取json文件时，不支持数据类型推断，可在读取时指定数据类型。</description></item></channel></rss>